---
title: "Modelos poblacionales para la franja de Gaza"
author: "Javier Fern√°ndez-L√≥pez"
date: "03-10-2025"
output: 
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    number_sections: false
    toc_depth: 1
    #code_folding: hide
---

<style>
body {
text-align: justify}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
 
# Introducci√≥n

Con motivo de las movilizaciones de octubre de 2025 demandando el fin del conflicto en Gaza, se ha desarrollado una clase pr√°ctica en el marco de la asignatura de Biomatem√°ticas aplicando los conceptos estudiados hasta la fecha a la situaci√≥n demogr√°fica de Gaza. El objetivo ha sido doble: visibilizar la dimensi√≥n de la masacre y demostrar la utilidad de los modelos demogr√°ficos estudiados en la asignatura. Durante la sesi√≥n, se ha realizado una peque√±a introducci√≥n al contexto hist√≥rico de la regi√≥n de Palestina. Dado que profundizar en tal contexto excede a las capacidades del docente y quedan fuera de los objetivos de la asignatura, se han proporcionado fuentes adicionales para que el alumnado se docuementen por su cuenta. En concreto, se ha mencionado el Episodio 2 de la serie documental [**Cuando el mundo se tambalea: La creaci√≥n del Estado de Israel**](https://www.youtube.com/watch?v=iw2qx7LJiW0), una producci√≥n francesa que trata sobre los acontecimientos hist√≥ricos m√°s trascendentes desde los a√±os 40 hasta la actualidad.
  
Dado que la cantidad y complejidad de modelos estudiados durante el curso es muy limitado, el ejemplo es puramente demostrativo y los modelos aplicados muy (demasiado) sencillos. A√∫n as√≠, y entendiendo que _**todo modelo es una simplificaci√≥n de la realidad que debe servir para comprender y/o predecir parte de la misma**_, la actividad planteada encaja con las Competencias a adquirir en la asignatura de Biomatem√°ticas del Grado de Ciencias Biol√≥gicas de la Universidad Complutense de Madrid.


# Enunciado del ejercicio

Hasta octubre de 2023, la poblaci√≥n de la franja de Gaza ten√≠a un crecimiento leve que podr√≠a seguir un modelo de Malthus con par√°metro $a=0.0005$. Seg√∫n el Palestinian Central Bureau of Statistics, en el momento de los atentados de Ham√°s el tama√±o poblacional de la franja [**se estimaba en aproximadamente 2.226.000 personas**](https://www.pcbs.gov.ps/site/lang__en/881/default.aspx) ($y_0 = 2.226$ millones). Seg√∫n las Autoridades Palestinas, la poblaci√≥n de Gaza a enero de 2025 se hab√≠a [**reducido aproximadamente un 6%**](https://www.euronews.com/2025/01/02/palestinian-statistics-bureau-projects-gaza-population-down-by-6-since-start-of-war) desde el inicio de los bombardeos por parte del ej√©rcito israel√≠ ($y_{15} = 2.1$ millones). A partir de estos datos, se busca:

  1. Asumiendo un modelo de Malthus sencillo, ¬øqu√© poblaci√≥n ten√≠a la franja en enero de 2023 ($t=-9$)?
  2. Construir un modelo poblacional que refleje la situaci√≥n desde octubre del 2023 hasta la actualidad y calcular la poblaci√≥n en octubre de 2025 ($t=24$) seg√∫n ese modelo.
  3. Calcular la poblaci√≥n en enero de 2026 ($t=27$) bajo dos escenarios:
  
   * A) Alto el fuego inmediato
   * B) Continuaci√≥n con la matanza actual
    
  4. Calcular el cambio demogr√°fico total en octubre de 2025 ($t=24$) en la franja si no se hubiera producido el conflicto.

# Apartado 1)

El modelo de Malthus estudiado en clase establece que el crecimiento poblacional $y'(t)$ est√° relacionado con el propio tama√±o poblacional $y(t)$, y puede expresarse mediante la siguiente ecuaci√≥n diferencial:

\begin{equation*}
y'(t) = ay(t)
\end{equation*}
donde  $a$ es la tasa de crecimiento _per capita_. Al resolver esta ecuaci√≥n diferencial e imponer condiciones iniciales, obtenemos la soluci√≥n particular del modelo de Malthus que hemos estudiado:

\begin{equation*}
y(t) = y_0 e^{at}
\end{equation*}

Como sabemos que en el modelo de Malthus la tasa $a$ permanece constante y en nuestro caso $a=0.0005$, sabiendo que la poblaci√≥n en octubre del 2023 era $y_0 = 2.226$ millones, podemos sustituir para obtener la poblaci√≥n en enero de 2023 ($t = -9$):

\begin{equation*}
y(-9) = 2.226 e^{-0.0005*9} = 2.216
\end{equation*}

En el lenguaje R simplemente escribir√≠amos en la consola ``2.226*exp(-0.0005*9)`` y obtendr√≠amos que la poblaci√≥n en enero de 2023 rondar√≠a los 2.216 millones seg√∫n nuestro modelo.

# Apartado 2)

A partir de los atentados de Ham√°s en octubre de 2023 comienza el asedio de la franja por parte del ej√©rcito israel√≠, lo que conlleva una p√©rdida de poblaci√≥n a causa tanto de la emigraci√≥n como de un aumento de la mortalidad. A esta p√©rdida de poblaci√≥n la denominaremos $P(t)$ y la interpretaremos como interpretamos como un factor que empeora la tasa de crecimiento neto. Por tanto, el ritmo de crecimiento del modelo de Malthus se ver√° ahora tambi√©n afectado por esta p√©rdida de poblaci√≥n. De esta forma tendr√≠amos:

\begin{equation*}
y'(t) = (a-P(t))y(t)
\end{equation*}

Podr√≠amos a√±adir un poco m√°s de control sobre el efecto de conflicto a√±adiendo un par√°metro $b$ que multiplicase a $P(t)$. Imaginemos, por ejemplo, que el conflicto se termina de golpe. Simplmente haciendo que $b=0$ podr√≠amos "apagar" el efecto negativo de $P(t)$ sobre $a$, volviendo al modelo de Malthus inicial. De la misma forma, subiendo o bajando el valor de $b$ podr√≠amos "modular" el efecto de $P(t)$, funcionar√≠a como un "ecualizador" o un "dial" que ajusta el efecto de $P(t)$. Esto hace tambi√©n que nuestro modelo sea m√°s flexible.

\begin{equation*}
y'(t) = (a-bP(t))y(t)
\end{equation*}

Pensemos ahora en el comportamiento de la p√©rdida de poblaci√≥n. Podr√≠amos pensar que esa p√©rdida de poblaci√≥n permanece constante en el tiempo:

```{r, echo=TRUE}
plot(x = 0:5, y = rep(5000, 6), type = "l", lwd = 2,
     xlab = "tiempo (en meses)",
     ylab = "P(t) (perdida de poblaci√≥n)")
```

Esta situaci√≥n indicar√≠a que en cada mes se pierden por ejemplo 5000 personas, y que este n√∫mero es constante y no var√≠a a lo largo del tiempo.

Sin embargo, podemos pensar que la p√©rdida de poblaci√≥n puede ir creciendo debido al empeoramiento de las condiciones de vida. Esta p√©rdida de poblaci√≥n (tanto por emigraci√≥n como por mortalidad) crecer√≠a desde $0$ en el instante $t=0$ (no hay p√©rdida de poblaci√≥n al principio), a un ritmo constante $r$. Esta situaci√≥n podr√≠a modelizarse mediante una simple ecuaci√≥n de una recta con pendiente $r$ e intercepto 0 (punto de corte de la recta con el eje Y):

\begin{equation*}
P'(t) = r
\end{equation*}
\begin{equation*}
P(t) = rt
\end{equation*}

```{r, echo=TRUE}
# Por ejemplo, para una r1=300 o r2=500
t <- 0:6
Pt_r1 <- 300*t
Pt_r2 <- 500*t

plot(x = t, y = Pt_r2, type = "l", col = "darkred",
     xlab = "tiempo (en meses)",
     ylab = "P(t) (p√©rdida de poblaci√≥n)", lwd = 2)
lines(x = t, y = Pt_r1, col = "darkblue", lwd = 2)
legend("topleft", legend=c("r1=300", "r2=500"),
       col=c("darkblue", "darkred"), lty=1, lwd = 2)
```

De esta forma tendr√≠amos que al inicio del conflicto no hay p√©rdida de poblaci√≥n, pero a medida que pasa el tiempo esa p√©rdida va aumentando, y ese aumento depende de los valores que tome $r$. Este modelo probablemente refleje mejor la situaci√≥n real que una p√©rdida constante de poblaci√≥n, as√≠ que es el que utilizaremos.

Ahora que sabemos c√≥mo evoluciona $P(t)$ a lo largo del tiempo, podemos sustituirlo en nuestro modelo de poblaci√≥n:

\begin{equation*}
y'(t) = (a-bP(t))y(t)
\end{equation*}
\begin{equation*}
P(t) = rt
\end{equation*}

\begin{equation*}
y'(t) = (a-brt)y(t)
\end{equation*}

Antes de seguir, echemos un vistazo a la ecuaci√≥n $y'(t) = (a-brt)y(t)$, donde $y'(t)$ es la variaci√≥n en el tama√±o poblacional en el tiempo $t$, $y(t)$ es el tama√±o poblacional en el tiempo $t$, $t$ es el tiempo y el resto son constantes. En la parte de la p√©rdida de poblaci√≥n $-brt$ hemos acabado teniendo dos constantes que se multiplican ($b$, que la hab√≠amos incluido al principio para, por ejemplo "apagar" el efecto de la p√©rdida de poblaci√≥n, y $r$, que representa la tasa a la que la p√©rdida de poblaci√≥n aumenta con el tiempo). Estas dos constantes que se multiplican pueden ser sustituidas por una nueva constante que representar√° el producto $k = b*r$. Esto facilitar√° los c√°lculos posteriores, ya que en lugar de tener dos inc√≥gnitas (que no podr√≠amos diferenciar entre una y otra), tendremos s√≥lo una. De esta forma, nuestro modelo quedar√≠a con la siguiente ecuaci√≥n diferencial:

\begin{equation*}
y'(t) = (a-kt)y(t)
\end{equation*}

donde $y'(t)$ es la variaci√≥n en el tama√±o poblacional en el tiempo $t$, $a$ es la tasa de crecimiento poblacional en ausencia de conflicto, $k$ es una constante que modula la p√©rdida de poblaci√≥n, $t$ es el tiempo e $y(t)$ es el tama√±o poblaci√≥nal en el tiempo $t$.

Ahora debemos resolver esta ecuaci√≥n diferencial e imponer condiciones iniciales para obtener la ecuaci√≥n de funci√≥n de efectivos de nuestro modelo:

\begin{equation*}
\frac{dy}{dt} = (a-kt)y
\end{equation*}

\begin{equation*}
\frac{dy}{y} = (a-kt)dt
\end{equation*}

\begin{equation*}
\int \frac{1}{y}dy = \int(a-kt)dt
\end{equation*}

\begin{equation*}
\ln(y) + c_1 = \int a dt - \int kt dt
\end{equation*}

\begin{equation*}
ln(y) + c_1 = at + c_2 - k\int t dt
\end{equation*}

\begin{equation*}
ln(y) + c_1 = at + c_2 - k \frac{t^2}{2} + c_3
\end{equation*}

\begin{equation*}
ln(y) = at - k \frac{t^2}{2} + c_4
\end{equation*}

\begin{equation*}
y(t) = e^{at - k \frac{t^2}{2} + c_4}
\end{equation*}

\begin{equation*}
y(t) = e^{at - k \frac{t^2}{2}} * e^{c_4}
\end{equation*}

\begin{equation*}
y(t) = e^{at - k \frac{t^2}{2}} * C
\end{equation*}

Que como hemos visto en clase, tras imponer condiciones iniciales obtenemos que $C=y_0$, por lo que reordenando obtenemos la siguiente soluci√≥n particular de nuestro modelo:

\begin{equation*}
y(t) = y_0 e^{at - \frac{1}{2} k t^2}
\end{equation*}

Este ser√≠a nuestro nuevo modelo que reflejar√≠a la nueva situaci√≥n de la demograf√≠a de la franja a partir de octubre de 2023. √önicmente nos queda conocer el valor del par√°metro $k$, que podemos obtener despej√°ndolo de la ecuaci√≥n, y utilizando los datos que nos proporciona el enunciado $y_0 = 2.226$ millones e $y_{15} = 2.1$ millones:

\begin{equation*}
k = \frac{2}{t^{2}}\left(a t - ln\frac{y(t)}{y_{0}}\right)
\end{equation*}

\begin{equation*}
k = \frac{2}{15^{2}}\left(0.0005*15 - ln\frac{2.1}{2.226}\right)
\end{equation*}

\begin{equation*}
k = 0.000584
\end{equation*}

Para resolverlo, en la consola de R escribir√≠amos ``(2 / (15^2)) * (0.0005 * 15 - log(2.1 / 2.226))`` Una vez conocemos el valor de $k$, ya estar√≠amos en condiciones de calcular la poblaci√≥n de la franja en octubre de 2025 ($t=24$) utilizando la soluci√≥n particular de nuestro modelo:

\begin{equation*}
y(t) = y_0 e^{at - \frac{1}{2} k t^2}
\end{equation*}

\begin{equation*}
y(t=24) = 2.226 e^{(0.0005*24) - \frac{1}{2} 0.000584 * 24^2}
\end{equation*}

\begin{equation*}
y(t=24) \approx 1.905
\end{equation*}

Para resolverlo, en la consola de R escribir√≠amos ``2.226 * exp((0.0005 * 24) - 0.5 * 0.000584 * 24^2)``. Por lo tanto, seg√∫n nuestro modelo, la poblaci√≥n de la franja en octubre de 2025 ser√≠a de aproximadamente 1.905 millones de personas.

# Apartado 3)

En el apartado 3 nos piden que hagamos una predicci√≥n del tama√±o poblacional en el futuro (enero del 2026, $t=27$) seg√∫n nuestro modelo bajo dos escenarios.

En el escenario **A** se contempla un alto al fuego inmediato a partir de octubre de 2025, es decir, a partir de $t=24$. Una forma de simular este escenario es asumir que nuestra constante que modulaba el efecto de la p√©rdida demogr√°fica $k$ se hace 0 a partir de $t=24$, por lo que el modelo vuelve a comportarse como el Malthus inicial. Hay que tener en cuenta que para hacer estos los c√°lculos, el nuevo $y_0$ debe ser ahora la poblaci√≥n que hab√≠a en $t=24$, que es el momento a partir del cual el par√°metro $k$ se hace cero, y el tiempo para el que querr√≠amos predecir la poblaci√≥n ser√≠a $t=3$, esto es, 3 meses despu√©s de octubre de 2025. De este modo tendr√≠amos que:

\begin{equation*}
y(t) = y_0 e^{at - \frac{1}{2} k t^2}
\end{equation*}

\begin{equation*}
y(t=3) = 1.905 e^{(0.0005*3) - \frac{1}{2} 0 * 3^2}
\end{equation*}

\begin{equation*}
y(t=3) \approx 1.908
\end{equation*}

En la consola de R, introducir√≠amos la expresi√≥n ``1.905 * exp((0.0005 * 3) - 0.5 * 0 * 3^2)``. Nuestro modelo, si cesase por completo esa p√©rdida de poblaci√≥n y manteniendo la tasa de crecimiento anterior al conflicto, predice que en enero de 2026 la poblaci√≥n de la franja ser√≠a $1.908$ millones de personas.

En el escenario **B** seguir√≠a como hasta ahora. Por lo tanto, como el modelo no cambia por no haber ning√∫n alto el fuego, podemos seguir utilizando la poblaci√≥n al inicio del conflicto como $y_0$ y calcular la poblaci√≥n para 27 meses despu√©s ($t=27$), esto es, en enero de 2026:

\begin{equation*}
y(t) = y_0 e^{at - \frac{1}{2} k t^2}
\end{equation*}

\begin{equation*}
y(t=27) = 2.226 e^{(0.0005*27) - \frac{1}{2} 0.000584 * 27^2}
\end{equation*}

\begin{equation*}
y(t=27) \approx 1.83
\end{equation*}

De no cesar el conflicto, nuestro modelo predice una poblaci√≥n en enero de 2026 de aproximadamente $1.83$ millones de personas.

# Apartado 4)

Por √∫ltimo el enunciado nos pide calcular el cambio demogr√°fico total a fecha de octubre de 2025 ($t=24$) en la franja si no se hubiera producido el conflicto. Aunque puede parecer que simplemente podemos restar la poblaci√≥n que hab√≠a en octubre del 2023 y la poblaci√≥n que hemos calculado en 2025, debemos tener en cuenta que la poblaci√≥n que tendr√≠amos en la franja en la actualidad no se habr√≠a mantenido constante, sino que ven√≠a creciendo ligeramente, por lo que debemos proyectar nuestro primer modelo de Malthus desde octubre del 2023 hasta octubre del 2025, y despu√©s restarle la estima teniendo en cuenta el conflicto:

\begin{equation*}
y(t) = y_0 e^{at}
\end{equation*}

\begin{equation*}
y_{sinconflicto}(24) = 2.226 e^{0.0005*24} \approx 2.25
\end{equation*}

Por tanto, tenemos que la poblaci√≥n en la franja habr√≠a sido a fecha de octubre de 2025 de aproximadamente 2.25 millones de personas. A esta cifra le podemos restar lo estimado teniendo en cuenta el conflicto, que es 1.905 millones:
\begin{equation*}
y_{sinconflicto}(24) - y(24)
\end{equation*}
\begin{equation*}
2.25 - 1.905 = 0.345
\end{equation*}

El resultado arroja una p√©rdida de poblaci√≥n de 345,000 personas, en el que est√° contemplado los desplazamientos, los fallecimientos y el no crecimiento de la poblaci√≥n durante el conflicto.

# Comentarios y conclusiones

Es obvio que estos modelos tan sencillos no reflejan al completo la realidad de la demograf√≠a de la franja. Sin embargo, se demuestra la utilidad de los modelos para hacer estimas, predicciones y evaluaciones de diferentes escenarios. Se insta al lector a reflexionar sobre otros procesos que podr√≠an estar afectando, as√≠ como su inclusi√≥n en los modelos.

Seg√∫n nuestras estimas aproximadamente 300,000 personas han sido desplazadas o asesinadas desde el inicio del conflicto. Esto es el equivalente a la totalidad de la poblaci√≥n de ciudades como Alicante o C√≥rdoba, en Espa√±a.

```{r, echo=FALSE, warning= FALSE, message=FALSE}
# --- Librer√≠as ---
library(ggplot2)
library(dplyr)
library(tidyr)
library(scales)

# --- Par√°metros ---
y0 <- 2.226       # millones (oct-2023)
a  <- 0.0005      # tasa mensual natural
k  <- 0.000584    # intensidad del conflicto (kappa)
t_cut <- 24       # oct-2025 -> 24 meses desde oct-2023

# --- Fechas clave ---
date_start <- as.Date("2023-01-01")
date_y0    <- as.Date("2023-10-01")
date_cut   <- as.Date("2025-10-01")
date_end   <- as.Date("2026-01-01")

# Conversi√≥n de fechas a meses desde y0
month_len <- 365.2425 / 12
mfrom_y0 <- function(d) as.numeric(d - date_y0) / month_len

# --- Modelos ---
# Malthus simple (sin conflicto)
y_malthus <- function(t) y0 * exp(a * t)

# Malthus modificado (con k > 0)
y_conflict <- function(t) {
  ifelse(t < 0, y_malthus(t),
         y0 * exp(a * t - 0.5 * k * t^2))
}

# Escenario B: alto el fuego (k=0 desde t_cut)
y_k0_after <- function(t, t_cut = 24) {
  y_24 <- y0 * exp(a * t_cut - 0.5 * k * t_cut^2)
  ifelse(t <= t_cut,
         y_conflict(t),
         y_24 * exp(a * (t - t_cut)))
}

# --- Serie temporal ---
dates <- seq(date_start, date_end, by = "1 day")
t <- mfrom_y0(dates)

# --- Trayectorias ---
df <- tibble(
  date = dates,
  t = t,
  `Malthus (enero-2023 ‚Üí oct-2023)` = ifelse(t <= 0, y_malthus(t), NA),
  `Modelo con conflicto (oct-2023 ‚Üí oct-2025)` = ifelse(t >= 0 & t <= 24, y_conflict(t), NA),
  `Escenario A: contin√∫a igual` = ifelse(t >= 24, y_conflict(t), NA),
  `Escenario B: alto el fuego` = ifelse(t >= 24, y_k0_after(t), NA),
  `Contrafactual: sin conflicto` = ifelse(t >= 0 & t <= 24, y_malthus(t), NA)
) %>%
  pivot_longer(-c(date, t), names_to = "Modelo", values_to = "y")

# --- Gr√°fico ---
ggplot(df, aes(x = date, y = y, color = Modelo, linetype = Modelo)) +
  geom_line(size = 1) +
  geom_vline(xintercept = as.numeric(date_y0), linetype = "dashed", color = "black") +
  geom_vline(xintercept = as.numeric(date_cut), linetype = "dotted", color = "black") +
  annotate("text", x = date_y0, y = 2.27, label = "Oct-2023 (y0)", hjust = -0.1, angle = 90, size = 3) +
  annotate("text", x = date_cut, y = 2.27, label = "Oct-2025", hjust = -0.1, angle = 90, size = 3) +
  scale_x_date(date_breaks = "3 months", date_labels = "%b-%Y") +
  scale_y_continuous(labels = label_number(big.mark = ".", decimal.mark = ",")) +
  labs(
    title = "Evoluci√≥n de la poblaci√≥n en Gaza (ene-2023 a ene-2026)",
    subtitle = "Modelos: Malthus, conflicto y escenarios tras oct-2025",
    x = "Fecha", y = "Poblaci√≥n (millones)",
    color = NULL, linetype = NULL
  ) +
  theme_minimal(base_size = 12) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "top",
    legend.text = element_text(size = 7),     # üîπ hace m√°s peque√±a la leyenda
    legend.key.width = unit(1.5, "lines"),    # üîπ acorta las l√≠neas de la leyenda
    legend.key.height = unit(0.5, "lines"),   # üîπ reduce altura de las filas
    legend.spacing.x = unit(0.2, "cm"),       # üîπ reduce espacio horizontal
    legend.box = "horizontal",                # üîπ las leyendas se colocan en fila
    legend.box.just = "center",               # üîπ centradas
    plot.title = element_text(hjust = 0.5, size = 13),
    plot.subtitle = element_text(hjust = 0.5, size = 10)
  ) +
  guides(
    color = guide_legend(nrow = 2, byrow = TRUE),
    linetype = guide_legend(nrow = 2, byrow = TRUE)
  )


```

